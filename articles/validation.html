<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Results validation • HRaDeX</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Results validation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HRaDeX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example.html">Experimental example</a></li>
    <li><a class="dropdown-item" href="../articles/gui_guide.html">How to use the apps?</a></li>
    <li><a class="dropdown-item" href="../articles/validation.html">Results validation</a></li>
    <li><a class="dropdown-item" href="../articles/workflow_performance.html">Workflow performance</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow description</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="validation_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="validation_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="validation_files/d3-bundle-5.16.0/d3-bundle.min.js"></script><script src="validation_files/d3-lasso-0.0.5/d3-lasso.min.js"></script><script src="validation_files/save-svg-as-png-1.4.17/save-svg-as-png.min.js"></script><script src="validation_files/flatbush-4.4.0/flatbush.min.js"></script><link href="validation_files/ggiraphjs-0.8.10/ggiraphjs.min.css" rel="stylesheet">
<script src="validation_files/ggiraphjs-0.8.10/ggiraphjs.min.js"></script><script src="validation_files/girafe-binding-0.8.11/girafe.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Results validation</h1>
            
      

      <div class="d-none name"><code>validation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-to-validate-the-results">How to validate the results?<a class="anchor" aria-label="anchor" href="#how-to-validate-the-results"></a>
</h2>
<p>This article describes the featured methods of validation of the
HRaDeX workflow, based on the peptide uptake curve fitting, and the
aggregation of fitted parameters from the peptide level into
high-resolution. As this process is dependent on many parameters, we
offer the possibility to validate the analysis in multiple steps.</p>
<p>For more information about the workflow check dedicated <a href="https://hadexversum.github.io/HRaDeX/articles/workflow.html">article</a>.</p>
<p>Let’s start with running the analysis, using exemplary <a href="https://doi.org/10.1093/nar/gkac685" class="external-link">data</a>, and default
parameters.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">protein_length</span> <span class="op">&lt;-</span> <span class="fl">224</span> <span class="op">+</span> <span class="fl">1</span> <span class="co">## as r3dmol counts differently</span></span>
<span></span>
<span><span class="co"># calucalting deuterium uptake for the alpha component</span></span>
<span><span class="va">kin_dat</span> <span class="op">&lt;-</span> <span class="fu">HRaDeX</span><span class="fu">::</span><span class="fu"><a href="../reference/prepare_kin_dat.html">prepare_kin_dat</a></span><span class="op">(</span><span class="va">alpha_dat</span>, </span>
<span>                                   state <span class="op">=</span> <span class="st">"Alpha_KSCN"</span>,</span>
<span>                                   time_0 <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                   time_100 <span class="op">=</span> <span class="fl">1440</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_k_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k_1 <span class="op">=</span> <span class="fl">2</span>, k_2 <span class="op">=</span> <span class="fl">0.2</span>, k_3 <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k_1 <span class="op">=</span> <span class="fl">1</span>, k_2 <span class="op">=</span> <span class="fl">0.1</span>, k_3 <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>k_1 <span class="op">=</span> <span class="fl">30</span>, k_2 <span class="op">=</span> <span class="fl">1</span>, k_3 <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># the fitting process for the whole peptide pool</span></span>
<span><span class="va">fit_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_fit_dataset.html">create_fit_dataset</a></span><span class="op">(</span><span class="va">kin_dat</span>, </span>
<span>                                 fit_k_params <span class="op">=</span> <span class="va">fit_k_params</span>, </span>
<span>                                 trace <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                                 fractional <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                                 workflow <span class="op">=</span> <span class="fl">321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># aggregation of the peptide level results in high-resolution data</span></span>
<span><span class="va">hires_params</span> <span class="op">&lt;-</span> <span class="fu">calculate_hires</span><span class="op">(</span><span class="va">fit_values</span>,</span>
<span>                                fractional <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                                method <span class="op">=</span> <span class="st">"weighted"</span>,</span>
<span>                                protein_length <span class="op">=</span> <span class="va">protein_length</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="fit-selection">Fit selection<a class="anchor" aria-label="anchor" href="#fit-selection"></a>
</h3>
<p>Depending on the supplied data, the fitting process for each peptide
includes fitting all selected possible functions: three-, two- and
one-component exchange functions. The best-fitted model is selected
based on the BIC value. Although it is impossible to investigate the
results of all possible models, we can analyze the chosen one.</p>
<p>The BIC values are presented in the data frame containing fitting
results, as well as RSS. Then, it is possible to draw the fitted model
alongside the experimental data to control if the result is
satisfactory.</p>
<p>Here we present the results for one, selected peptide DVAAF:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_fit_dat</span></span>
<span><span class="co">#&gt;    id   Protein      State sequence start end max_uptake       n_1      k_1</span></span>
<span><span class="co">#&gt; 1 106 db_eEF1Ba Alpha_KSCN    DVAAF   217 221          4 0.4973596 9.334779</span></span>
<span><span class="co">#&gt;         n_2 k_2       n_3        k_3          rss       bic class_name    k_est</span></span>
<span><span class="co">#&gt; 1 0.1422129   1 0.3623463 0.06211225 7.381055e-06 -52.08054         NA 4.798254</span></span>
<span><span class="co">#&gt;   fitted   color</span></span>
<span><span class="co">#&gt; 1      3 #7F245C</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_double_uc.html">plot_double_uc</a></span><span class="op">(</span><span class="va">example_kin_dat</span>, <span class="va">example_fit_dat</span><span class="op">)</span></span></code></pre></div>
<p><img src="validation_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>On the right panel, there is a normalized experimental uptake curve,
with a logarithmic time scale. The circles mark the fractional deuterium
uptake. Inside the circles, there are error bars presenting the combined
uncertainty of the measured fractional deuterium uptake. Due to the
quality of the presented data, the error bars are barely visible. The
black line indicates the fitted three-component exchange function, while
the red, green, and blue lines indicate the components of the fitted
(fast, medium, and slow exchanging group, respectively). On the right,
there is an uptake curve presenting deuterium uptake in Daltons, for
users to grasp an understanding of uptake curve types.</p>
<p>This function can be plotted for any peptide, preferably ones
selected by the user, e.q. with the greatest RSS values.</p>
<ul>
<li>Future plans: package function to create the pdf file with all of
the uptake curves.*</li>
</ul>
<div class="section level4">
<h4 id="in-gui">In GUI<a class="anchor" aria-label="anchor" href="#in-gui"></a>
</h4>
<p>In the <code>UC plots</code> tab, there are listed plots (the ones
described just above) for all of the available peptides. Those plots are
static, serving the purpose of a quick glimpse of the quality of the
fits. For more in-detail analysis, there are plots available upon
clicking the selected peptide name in the table with parameters, in the
<code>Fit params</code> tab. Not only there are precise numeric values
presented in the table, but the plots below are interactive.</p>
</div>
</div>
<div class="section level3">
<h3 id="region-classification-consistency">Region classification consistency<a class="anchor" aria-label="anchor" href="#region-classification-consistency"></a>
</h3>
<p>Before the final data aggregation step, it is important to check if
the classification results are consistent for overlapping peptides
within regions. The peptides close to each other should be classified
similarly, which can be noted by the presence of similar colors. The
long peptides (with lengths exceeding 10 amino acids) should be treated
carefully, as in their case it is harder to pinpoint the exact region of
exchange and distinguish between the exchange rates of the residues.</p>
<p>The plot below shows the coverage plot with assigned color-code
classification. We can see that the medium part - the linker of the
alpha compound - is exchanging very fast due to a lack of protection.
The C- and N-terminus parts of the protein show the consistency of
region classification.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">HRaDeX</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_cov_class.html">plot_cov_class</a></span><span class="op">(</span><span class="va">fit_values</span><span class="op">)</span></span></code></pre></div>
<div class="girafe html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"html":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='graphics-document' id='svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec' viewBox='0 0 720 288'>\n <defs id='svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_defs'>\n  <clipPath id='svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_c1'>\n   <rect x='0' y='0' width='720' height='288'/>\n  <\/clipPath>\n  <clipPath id='svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_c2'>\n   <rect x='34.8' y='38.16' width='676.23' height='197.96'/>\n  <\/clipPath>\n <\/defs>\n <g id='svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_rootg' class='ggiraph-svg-rootg'>\n  <g clip-path='url(#svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_c1)'>\n   <rect x='0' y='0' width='720' height='288' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\n   <rect x='-0' y='0' width='720' height='288' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='round'/>\n  <\/g>\n  <g clip-path='url(#svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_c2)'>\n   <rect x='34.8' y='38.16' width='676.23' height='197.96' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\n   <polyline points='34.80,192.52 711.03,192.52' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='34.80,123.30 711.03,123.30' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='34.80,54.08 711.03,54.08' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='134.77,236.13 134.77,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='273.23,236.13 273.23,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='411.69,236.13 411.69,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='550.14,236.13 550.14,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='688.60,236.13 688.60,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='0.87' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='34.80,227.13 711.03,227.13' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='34.80,157.91 711.03,157.91' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='34.80,88.69 711.03,88.69' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='65.54,236.13 65.54,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='204.00,236.13 204.00,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='342.46,236.13 342.46,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='480.92,236.13 480.92,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='619.37,236.13 619.37,38.16' fill='none' stroke='#EBEBEB' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <rect x='68.31' y='213.28' width='30.46' height='13.84' fill='#795A2C' fill-opacity='1' stroke='none'/>\n   <rect x='71.08' y='199.44' width='27.69' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='73.85' y='185.6' width='24.92' height='13.84' fill='#F70008' fill-opacity='1' stroke='none'/>\n   <rect x='79.39' y='171.75' width='16.62' height='13.84' fill='#F70008' fill-opacity='1' stroke='none'/>\n   <rect x='79.39' y='157.91' width='19.38' height='13.84' fill='#F5000A' fill-opacity='1' stroke='none'/>\n   <rect x='90.46' y='144.07' width='16.62' height='13.84' fill='#906F00' fill-opacity='1' stroke='none'/>\n   <rect x='98.77' y='213.28' width='13.85' height='13.84' fill='#22B429' fill-opacity='1' stroke='none'/>\n   <rect x='98.77' y='199.44' width='16.62' height='13.84' fill='#579512' fill-opacity='1' stroke='none'/>\n   <rect x='107.08' y='185.6' width='16.62' height='13.84' fill='#50AF00' fill-opacity='1' stroke='none'/>\n   <rect x='107.08' y='171.75' width='19.38' height='13.84' fill='#5A7431' fill-opacity='1' stroke='none'/>\n   <rect x='112.62' y='213.28' width='16.62' height='13.84' fill='#AB5400' fill-opacity='1' stroke='none'/>\n   <rect x='112.62' y='157.91' width='19.38' height='13.84' fill='#B94600' fill-opacity='1' stroke='none'/>\n   <rect x='112.62' y='144.07' width='47.08' height='13.84' fill='#E70018' fill-opacity='1' stroke='none'/>\n   <rect x='118.15' y='199.44' width='41.54' height='13.84' fill='#F0000F' fill-opacity='1' stroke='none'/>\n   <rect x='123.69' y='185.6' width='36' height='13.84' fill='#F4000B' fill-opacity='1' stroke='none'/>\n   <rect x='126.46' y='171.75' width='13.85' height='13.84' fill='#F80007' fill-opacity='1' stroke='none'/>\n   <rect x='126.46' y='130.22' width='33.23' height='13.84' fill='#F3000C' fill-opacity='1' stroke='none'/>\n   <rect x='129.23' y='213.28' width='30.46' height='13.84' fill='#F0000F' fill-opacity='1' stroke='none'/>\n   <rect x='132' y='157.91' width='16.62' height='13.84' fill='#F60009' fill-opacity='1' stroke='none'/>\n   <rect x='132' y='116.38' width='24.92' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='132' y='102.54' width='27.69' height='13.84' fill='#F2000D' fill-opacity='1' stroke='none'/>\n   <rect x='140.31' y='171.75' width='19.38' height='13.84' fill='#D32C00' fill-opacity='1' stroke='none'/>\n   <rect x='159.69' y='213.28' width='13.85' height='13.84' fill='#4DAD05' fill-opacity='1' stroke='none'/>\n   <rect x='168' y='199.44' width='30.46' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='168' y='185.6' width='33.23' height='13.84' fill='#D70028' fill-opacity='1' stroke='none'/>\n   <rect x='168' y='171.75' width='38.77' height='13.84' fill='#B74800' fill-opacity='1' stroke='none'/>\n   <rect x='168' y='157.91' width='41.54' height='13.84' fill='#7F8000' fill-opacity='1' stroke='none'/>\n   <rect x='170.77' y='144.07' width='30.46' height='13.84' fill='#DB0024' fill-opacity='1' stroke='none'/>\n   <rect x='170.77' y='130.22' width='36' height='13.84' fill='#DF0020' fill-opacity='1' stroke='none'/>\n   <rect x='170.77' y='116.38' width='38.77' height='13.84' fill='#9D6200' fill-opacity='1' stroke='none'/>\n   <rect x='173.54' y='213.28' width='27.69' height='13.84' fill='#DA0025' fill-opacity='1' stroke='none'/>\n   <rect x='176.31' y='102.54' width='24.92' height='13.84' fill='#E2001D' fill-opacity='1' stroke='none'/>\n   <rect x='176.31' y='88.69' width='30.46' height='13.84' fill='#E3001C' fill-opacity='1' stroke='none'/>\n   <rect x='206.77' y='213.28' width='19.38' height='13.84' fill='#609B04' fill-opacity='1' stroke='none'/>\n   <rect x='209.54' y='199.44' width='16.62' height='13.84' fill='#559613' fill-opacity='1' stroke='none'/>\n   <rect x='226.15' y='213.28' width='44.31' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='226.15' y='199.44' width='58.15' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='242.77' y='185.6' width='41.54' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='242.77' y='171.75' width='52.61' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='242.77' y='157.91' width='58.15' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='248.31' y='144.07' width='47.08' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='270.46' y='213.28' width='30.46' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='295.38' y='199.44' width='55.38' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='300.92' y='213.28' width='49.85' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='303.69' y='185.6' width='47.08' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='334.15' y='171.75' width='16.62' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='348' y='157.91' width='16.62' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='350.76' y='213.28' width='13.85' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='350.76' y='199.44' width='47.08' height='13.84' fill='#FB0004' fill-opacity='1' stroke='none'/>\n   <rect x='350.76' y='185.6' width='49.85' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='350.76' y='171.75' width='55.38' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='361.84' y='144.07' width='49.85' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='364.61' y='213.28' width='47.08' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='406.15' y='199.44' width='36' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='411.69' y='213.28' width='30.46' height='13.84' fill='#FF0000' fill-opacity='1' stroke='none'/>\n   <rect x='442.15' y='213.28' width='19.38' height='13.84' fill='#6E454B' fill-opacity='1' stroke='none'/>\n   <rect x='442.15' y='199.44' width='22.15' height='13.84' fill='#5C2D77' fill-opacity='1' stroke='none'/>\n   <rect x='444.92' y='185.6' width='16.62' height='13.84' fill='#793F48' fill-opacity='1' stroke='none'/>\n   <rect x='461.53' y='213.28' width='22.15' height='13.84' fill='#4C00B3' fill-opacity='1' stroke='none'/>\n   <rect x='461.53' y='185.6' width='30.46' height='13.84' fill='#553278' fill-opacity='1' stroke='none'/>\n   <rect x='464.3' y='199.44' width='30.46' height='13.84' fill='#6F3C54' fill-opacity='1' stroke='none'/>\n   <rect x='491.99' y='213.28' width='16.62' height='13.84' fill='#1700E8' fill-opacity='1' stroke='none'/>\n   <rect x='494.76' y='199.44' width='13.85' height='13.84' fill='#0900F6' fill-opacity='1' stroke='none'/>\n   <rect x='508.61' y='213.28' width='19.38' height='13.84' fill='#690294' fill-opacity='1' stroke='none'/>\n   <rect x='508.61' y='199.44' width='24.92' height='13.84' fill='#840C6F' fill-opacity='1' stroke='none'/>\n   <rect x='508.61' y='185.6' width='27.69' height='13.84' fill='#82007D' fill-opacity='1' stroke='none'/>\n   <rect x='508.61' y='171.75' width='47.08' height='13.84' fill='#794244' fill-opacity='1' stroke='none'/>\n   <rect x='511.38' y='157.91' width='24.92' height='13.84' fill='#9B0064' fill-opacity='1' stroke='none'/>\n   <rect x='511.38' y='144.07' width='44.31' height='13.84' fill='#7E433E' fill-opacity='1' stroke='none'/>\n   <rect x='516.91' y='130.22' width='19.38' height='13.84' fill='#CE0031' fill-opacity='1' stroke='none'/>\n   <rect x='516.91' y='116.38' width='38.77' height='13.84' fill='#9B3E26' fill-opacity='1' stroke='none'/>\n   <rect x='516.91' y='102.54' width='77.54' height='13.84' fill='#745833' fill-opacity='1' stroke='none'/>\n   <rect x='525.22' y='88.69' width='55.38' height='13.84' fill='#7C1F63' fill-opacity='1' stroke='none'/>\n   <rect x='527.99' y='213.28' width='22.15' height='13.84' fill='#734646' fill-opacity='1' stroke='none'/>\n   <rect x='527.99' y='74.85' width='27.69' height='13.84' fill='#FB0004' fill-opacity='1' stroke='none'/>\n   <rect x='527.99' y='61.01' width='41.54' height='13.84' fill='#794541' fill-opacity='1' stroke='none'/>\n   <rect x='527.99' y='47.16' width='44.31' height='13.84' fill='#7F4A36' fill-opacity='1' stroke='none'/>\n   <rect x='533.53' y='199.44' width='36' height='13.84' fill='#8C571C' fill-opacity='1' stroke='none'/>\n   <rect x='550.14' y='213.28' width='44.31' height='13.84' fill='#566742' fill-opacity='1' stroke='none'/>\n   <rect x='555.68' y='185.6' width='38.77' height='13.84' fill='#5C7131' fill-opacity='1' stroke='none'/>\n   <rect x='577.84' y='199.44' width='16.62' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='591.68' y='171.75' width='33.23' height='13.84' fill='#6D5B37' fill-opacity='1' stroke='none'/>\n   <rect x='591.68' y='157.91' width='36' height='13.84' fill='#655743' fill-opacity='1' stroke='none'/>\n   <rect x='594.45' y='213.28' width='30.46' height='13.84' fill='#706B24' fill-opacity='1' stroke='none'/>\n   <rect x='594.45' y='199.44' width='33.23' height='13.84' fill='#676434' fill-opacity='1' stroke='none'/>\n   <rect x='594.45' y='185.6' width='36' height='13.84' fill='#697521' fill-opacity='1' stroke='none'/>\n   <rect x='602.76' y='144.07' width='22.15' height='13.84' fill='#966900' fill-opacity='1' stroke='none'/>\n   <rect x='602.76' y='130.22' width='24.92' height='13.84' fill='#887700' fill-opacity='1' stroke='none'/>\n   <rect x='605.53' y='116.38' width='19.38' height='13.84' fill='#CC0033' fill-opacity='1' stroke='none'/>\n   <rect x='605.53' y='102.54' width='22.15' height='13.84' fill='#9D6200' fill-opacity='1' stroke='none'/>\n   <rect x='611.07' y='88.69' width='16.62' height='13.84' fill='#B90046' fill-opacity='1' stroke='none'/>\n   <rect x='624.91' y='213.28' width='16.62' height='13.84' fill='#1200ED' fill-opacity='1' stroke='none'/>\n   <rect x='624.91' y='171.75' width='19.38' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='624.91' y='144.07' width='22.15' height='13.84' fill='#0600F9' fill-opacity='1' stroke='none'/>\n   <rect x='627.68' y='199.44' width='16.62' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='627.68' y='157.91' width='19.38' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='627.68' y='130.22' width='22.15' height='13.84' fill='#1400EB' fill-opacity='1' stroke='none'/>\n   <rect x='630.45' y='185.6' width='16.62' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='633.22' y='116.38' width='13.85' height='13.84' fill='#0000FF' fill-opacity='1' stroke='none'/>\n   <rect x='644.3' y='213.28' width='22.15' height='13.84' fill='#40803F' fill-opacity='1' stroke='none'/>\n   <rect x='647.07' y='199.44' width='19.38' height='13.84' fill='#3D00C2' fill-opacity='1' stroke='none'/>\n   <rect x='647.07' y='185.6' width='22.15' height='13.84' fill='#3A00C5' fill-opacity='1' stroke='none'/>\n   <rect x='647.07' y='171.75' width='24.92' height='13.84' fill='#4E7B36' fill-opacity='1' stroke='none'/>\n   <rect x='649.83' y='157.91' width='16.62' height='13.84' fill='#4700B8' fill-opacity='1' stroke='none'/>\n   <rect x='652.6' y='144.07' width='16.62' height='13.84' fill='#4800B7' fill-opacity='1' stroke='none'/>\n   <rect x='666.45' y='213.28' width='13.85' height='13.84' fill='#7F245C' fill-opacity='1' stroke='none'/>\n   <rect x='34.8' y='38.16' width='676.23' height='197.96' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='round'/>\n  <\/g>\n  <g clip-path='url(#svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec_c1)'>\n   <polyline points='65.54,240.61 65.54,236.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='204.00,240.61 204.00,236.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='342.46,240.61 342.46,236.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='480.92,240.61 480.92,236.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='619.37,240.61 619.37,236.13' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.75' stroke-linejoin='round' stroke-linecap='butt'/>\n   <text x='60.96' y='254.69' font-size='10.8pt' font-family='DejaVu Sans' fill='#4D4D4D' fill-opacity='1'>0<\/text>\n   <text x='194.84' y='254.69' font-size='10.8pt' font-family='DejaVu Sans' fill='#4D4D4D' fill-opacity='1'>50<\/text>\n   <text x='328.72' y='254.69' font-size='10.8pt' font-family='DejaVu Sans' fill='#4D4D4D' fill-opacity='1'>100<\/text>\n   <text x='467.18' y='254.69' font-size='10.8pt' font-family='DejaVu Sans' fill='#4D4D4D' fill-opacity='1'>150<\/text>\n   <text x='605.64' y='254.69' font-size='10.8pt' font-family='DejaVu Sans' fill='#4D4D4D' fill-opacity='1'>200<\/text>\n   <text x='337.87' y='275.29' font-size='13.5pt' font-family='DejaVu Sans'>Position<\/text>\n   <text x='34.8' y='24.71' font-size='16.2pt' font-family='DejaVu Sans'>Assigned class on coverage<\/text>\n  <\/g>\n <\/g>\n<\/svg>","js":null,"uid":"svg_cfcd13d7_ee9d_4781_8134_ea27725b77ec","ratio":2.5,"settings":{"tooltip":{"css":".tooltip_SVGID_ { padding:5px;background:black;color:white;border-radius:2px;text-align:left; ; position:absolute;pointer-events:none;z-index:999;}","placement":"doc","opacity":0.9,"offx":10,"offy":10,"use_cursor_pos":true,"use_fill":false,"use_stroke":false,"delay_over":200,"delay_out":500},"hover":{"css":".hover_data_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_data_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_data_SVGID_ { fill:orange;stroke:black; }\nline.hover_data_SVGID_, polyline.hover_data_SVGID_ { fill:none;stroke:orange; }\nrect.hover_data_SVGID_, polygon.hover_data_SVGID_, path.hover_data_SVGID_ { fill:orange;stroke:none; }\nimage.hover_data_SVGID_ { stroke:orange; }","reactive":true,"nearest_distance":null},"hover_inv":{"css":""},"hover_key":{"css":".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\nimage.hover_key_SVGID_ { stroke:orange; }","reactive":true},"hover_theme":{"css":".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\nimage.hover_theme_SVGID_ { stroke:orange; }","reactive":true},"select":{"css":".select_data_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_data_SVGID_ { stroke:none;fill:red; }\ncircle.select_data_SVGID_ { fill:red;stroke:black; }\nline.select_data_SVGID_, polyline.select_data_SVGID_ { fill:none;stroke:red; }\nrect.select_data_SVGID_, polygon.select_data_SVGID_, path.select_data_SVGID_ { fill:red;stroke:none; }\nimage.select_data_SVGID_ { stroke:red; }","type":"multiple","only_shiny":true,"selected":[]},"select_inv":{"css":""},"select_key":{"css":".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_key_SVGID_ { stroke:none;fill:red; }\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\nimage.select_key_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"select_theme":{"css":".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\nimage.select_theme_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"zoom":{"min":1,"max":1,"duration":300},"toolbar":{"position":"topright","pngname":"diagram","tooltips":null,"fixed":false,"hidden":[],"delay_over":200,"delay_out":500},"sizing":{"rescale":true,"width":1}}},"evals":[],"jsHooks":[]}</script><div class="section level4">
<h4 id="in-gui-1">In GUI<a class="anchor" aria-label="anchor" href="#in-gui-1"></a>
</h4>
<p>This plot can be found in the <code>Overview</code> tab, as the
fourth plot from the top.</p>
</div>
</div>
<div class="section level3">
<h3 id="high-resolution-results">High-resolution results<a class="anchor" aria-label="anchor" href="#high-resolution-results"></a>
</h3>
<p>Once we have the data aggregated into the high-resolution level,
using one of two available methods, we can take a step back and
calculate the deuterium uptake for each peptide using the
high-resolution data for amino acids building that peptide. Then, we
plot the result next to the experimental data to check the goodness of
the data. Then, we calculate the MRSE - for each peptide and the whole
peptide pool.</p>
<p>Here, we use the <code>weighted</code> approach.</p>
<p>The comparison of recovered deuterium uptake and experimental
deuterium uptake can be presented on the plot:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/recreate_uc.html">recreate_uc</a></span><span class="op">(</span><span class="va">example_kin_dat</span>, <span class="va">fit_values</span>, hires_method <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in stat_function(fun = function(x) {: All aesthetics have length 1, but the data has 6 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span>
<span><span class="co">#&gt; Warning in stat_function(fun = function(x) {: All aesthetics have length 1, but the data has 6 rows.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please consider using `annotate()` or provide this layer with data containing</span></span>
<span><span class="co">#&gt;   a single row.</span></span></code></pre></div>
<p><img src="validation_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>This plot shows three pieces of information: the black points present
the experimental deuterium uptake, the blue line presents the fitted
three-component exchange function, and the red line presents the
recovered deuterium uptake values from high-resolution data. As we see,
the recovered uptake curve preserves the type of exchange and recovered
values are close to the experimental ones.</p>
<p>But judging goodness by the eye is not sufficient. We need a more
objective criterion - RMSE.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># recreating the uptake values for peptides</span></span>
<span><span class="va">rec_uc_dat_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_uc_from_hires_dataset.html">create_uc_from_hires_dataset</a></span><span class="op">(</span><span class="va">kin_dat</span>,</span>
<span>                                                <span class="va">fit_values</span>,</span>
<span>                                                hires_method <span class="op">=</span> <span class="st">"weighted"</span><span class="op">)</span></span>
<span><span class="co"># calcuation of RMSE</span></span>
<span><span class="va">rec_uc_rmse_dat_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_recovered_uc_rmse.html">calculate_recovered_uc_rmse</a></span><span class="op">(</span><span class="va">rec_uc_dat_alpha</span>, sort <span class="op">=</span> <span class="st">"ID"</span><span class="op">)</span></span></code></pre></div>
<p>The calculated RMSE for each peptide can be presented in two
forms:</p>
<ol style="list-style-type: lower-alpha">
<li>as <code>butterfly</code> plot. The Y-axis shows the RMSE values and
the X-axis shows the peptide by their ID. Although this plot offers an
overview of values and enables the choice of a satisfactory threshold,
it lacks information on length and position within the protein
structure.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_recovered_uc_coverage.html">plot_recovered_uc_coverage</a></span><span class="op">(</span><span class="va">rec_uc_rmse_dat_alpha</span>, style <span class="op">=</span> <span class="st">"butterfly"</span><span class="op">)</span></span></code></pre></div>
<p><img src="validation_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>as a <code>coverage</code> plot. Here, the RMSE values are shown in
the intensity of the red color, and the peptide position and length are
presented on the protein sequence.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_recovered_uc_coverage.html">plot_recovered_uc_coverage</a></span><span class="op">(</span><span class="va">rec_uc_rmse_dat_alpha</span>, style <span class="op">=</span> <span class="st">"coverage"</span><span class="op">)</span></span></code></pre></div>
<p><img src="validation_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>The total RMSE from all peptides is 0.0418 using the
<code>weighted</code> aggregation approach.</p>
<div class="section level4">
<h4 id="in-the-gui">In the GUI<a class="anchor" aria-label="anchor" href="#in-the-gui"></a>
</h4>
<p>This step is currently only available on the package side, but it
will be featured in the web server as well when the time comes.</p>
</div>
</div>
<div class="section level3">
<h3 id="what-to-improve">What to improve?<a class="anchor" aria-label="anchor" href="#what-to-improve"></a>
</h3>
<p>We controlled the steps of the analysis, and what to do next. If
there are some inconsistencies that are affecting the final result, it
may be beneficial to re-run the analysis with changed parameters.
Sometimes, when the regions of protein undergo the exchange slowly, the
<code>slow</code> exchange group should be shifted, leaving the
<code>medium</code> exchange ranges more broad.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
