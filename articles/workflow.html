<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Workflow description • HRaDeX</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Workflow description">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HRaDeX</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/example.html">Experimental example</a></li>
    <li><a class="dropdown-item" href="../articles/gui_guide.html">How to use the apps?</a></li>
    <li><a class="dropdown-item" href="../articles/workflow.html">Workflow description</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Workflow description</h1>
            
      

      <div class="d-none name"><code>workflow.Rmd</code></div>
    </div>

    
    
<p>Article under development. This article covers in detail the
classification workflow, alongside the numerical transformations. For
the methods of visualization of results obtained using classification
workflow, see the article on Visualization methods:
<code>vignette("visualization")</code>.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The baseline of the HDX-MS method is the investigation of the
exchange between hydrogen from the protein structure with deuterium from
the buffer in which the protein is suspended. The difference in mass
between hydrogen and deuterium is very close to 1 Da, so that we can
identify the mass uptake with the number of exchanged hydrogens.
Multiple time measurements allow us to see the exchange in time and
create an exchange curve of the process for each measured and identified
peptide (in a bottom-up approach).</p>
<p>The main challenge in HDX-MS is data analysis and interpretation.
Although different methods of analysis focus on numerical values, that
may be difficult to interpret, we wanted to propose a classification
method to simplify communication of the results. Moreover, we are
avoiding any data transformation, instead, propose a class label for
perfectly known and valid experimental curves.</p>
</div>
<div class="section level2">
<h2 id="classification-method">Classification method<a class="anchor" aria-label="anchor" href="#classification-method"></a>
</h2>
<p>This method aims to assign each peptide a specific combination of
exchange classes, consistent with experimental results. This allows us
to distinguish areas with different exchange patterns in the protein
sequence, and to describe the exchange process itself.</p>
<p>The class assignment is the final step of the classification process,
based on the literature description of the hydrogen-deuterium
phenomenon. The process has several steps, with multiple workflow
decisions under the experimenter’s control.</p>
<p>In the figure <em>x</em>, examples of experimental curves are
presented. Although it is easy to discriminate between the extreme cases
(described and defined in section <em>x</em>) - immediate exchange (red)
and none-exchange (black), we need a classification method to provide
information on the remaining curves (grey). The problem of
classification is mainly focused on them.</p>
<p><em>Future plans: the classification of the subfragments of the
overlapping peptides.</em></p>
<div class="section level3">
<h3 id="obtaining-the-uptake-curve">Obtaining the uptake curve<a class="anchor" aria-label="anchor" href="#obtaining-the-uptake-curve"></a>
</h3>
<p>The experimental data from the csv file is processed and
aggregated.<br>
Firstly, the deuterium uptake curve is prepared. It is a function of
deuterium uptake in time, with values defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mi>t</mi></msub><mo>=</mo><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">
    D_t = m_t - m_0
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mi>t</mi></msub><annotation encoding="application/x-tex">D_t</annotation></semantics></math>
is deuterium uptake in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
in daltons,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>t</mi></msub><annotation encoding="application/x-tex">m_t</annotation></semantics></math>
is mass of the peptide measured in time
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mn>0</mn></msub><annotation encoding="application/x-tex">m_0</annotation></semantics></math>
is mass of undeuterated peptide.</p>
<p>Then, the uptake curve is normalized. The values are scaled according
to the assumption, that the last time point of measurement or supplied
fully deuterated control (difference explained below) is the maximal
experimental deuterium uptake with 100% deuterium uptake. This can be
calculated in two ways:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>t</mi><mo>,</mo><mi>s</mi><mi>c</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>D</mi><mi>t</mi></msub><msub><mi>D</mi><mn>100</mn></msub></mfrac><mo>=</mo><mfrac><mrow><msub><mi>m</mi><mi>t</mi></msub><mo>−</mo><msub><mi>m</mi><mn>0</mn></msub></mrow><mrow><msub><mi>m</mi><mn>100</mn></msub><mo>−</mo><msub><mi>m</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
    D_{t, sc} = \frac{D_t}{D_{100}} = \frac{m_t - m_0}{m_{100} - m_0}
</annotation></semantics></math></p>
<p>This form of the uptake curve is used for the fitting process.
Because of this, we can operate using percentages for populations
(denoted as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>,
the fraction of exchangeable hydrogens) undergoing different exchange
patterns, and disregard the back-exchange problem for a while.</p>
<p><em>Comment on the difference between treating the last time point of
measurement as fully deuterated (FD) control and additionally prepared
fully deuteration control. When the first option is chosen, the last
time point of measurement measuremnt ia assigned the value of 100% of
deuterium uptake and the measurement point is taking part in the fitting
process. When the additional fully deuterated control is chosen, all the
measurement values are scaled with respect to that, but this FD value is
not assigned to any time point, and not taking part in the fitting
process, only the real measurement time points.</em></p>
</div>
<div class="section level3">
<h3 id="extreme-case-recognition">Extreme case recognition<a class="anchor" aria-label="anchor" href="#extreme-case-recognition"></a>
</h3>
<p>Firstly, we recognize extreme cases of uptake curve, and assigned
them a class name without fitting process.</p>
<p>For the peptide to be labeled as <strong>none exchange</strong>, has
to fulfill defined requirements:</p>
<ul>
<li>the uptake level [Da] in the last time point of measurement
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>D</mi><mn>100</mn></msub><annotation encoding="application/x-tex">D_{100}</annotation></semantics></math>)
is lower than 1 Da,</li>
<li>the thoretical deuterium uptake in the last time point of
measurement (scaled with respect to maximal possible uptake calculated
from the sequence) is lower than 10%.</li>
</ul>
<p>We interpret this case as a lack of observable exchange during the
course of experiment, and indicate it with the black color on the
visualization.</p>
<p>For the peptide to be disqualified from the fitting process and
labeled by <strong>invalid</strong> there has to be lack of sufficient
number of time points. It is crucial for the peptide to have valid
measurements for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>0</mn></msub><annotation encoding="application/x-tex">t_0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mn>100</mn></msub><annotation encoding="application/x-tex">t_100</annotation></semantics></math>,
as otherwise it prevents the normalization of values and causes the
falsyfication of data. The missing of one or two time points of
measurement (apart from controls) causes the use of two- or one-
component model, but does not prevent the fitting process.</p>
<p>The fitting process is not conducted for uptake curves classified as
extreme cases (no exchange or invalid).</p>
</div>
<div class="section level3">
<h3 id="exchange-class-definition">Exchange class definition<a class="anchor" aria-label="anchor" href="#exchange-class-definition"></a>
</h3>
<p>Following the literature - especially in a cornerstone of the studies
on the modeling hydrogen-deuterium exchange, the pioneering article of
Zhang and Smith , we expect the process of deuterium exchange for the
peptide to be described as a three-component equation <em>x</em>}:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msub><mi>n</mi><mn>1</mn></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>k</mi><mn>1</mn></msub><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>k</mi><mn>2</mn></msub><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>n</mi><mn>3</mn></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>k</mi><mn>3</mn></msub><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
D = n_1 \cdot (1 - exp(-k_1 \cdot t)) + n_2 \cdot (1-exp(-k_2 \cdot t)) + n_3 \cdot (1 - exp(-k_3 \cdot t)) 
</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>
indicates the population of i-th group and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>i</mi></msub><annotation encoding="application/x-tex">k_i</annotation></semantics></math>
is the exchange rate of i-th group. Moreover, we assume:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_1</annotation></semantics></math>
- fast exchange (red)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>2</mn></msub><annotation encoding="application/x-tex">k_2</annotation></semantics></math>
- medium exchange (green)</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>3</mn></msub><annotation encoding="application/x-tex">n_3</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>3</mn></msub><annotation encoding="application/x-tex">k_3</annotation></semantics></math>
- slow exchange (blue)</li>
</ul>
<p>Ideally,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>+</mo><msub><mi>n</mi><mn>2</mn></msub><mo>+</mo><msub><mi>n</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n_1 + n_2 + n_3 = 1</annotation></semantics></math>.
In this equation, we have six unknown parameters that need to be
found.</p>
<p>Unfortunately, the authors of this paper did not provide boundaries
for each exchange group. The ranges proposed by us, according to our
experience, can be found in table <em>x</em>.</p>
<p>The ranges of exchange rates can be changed if desired. However, we
recommend avoiding situations where a certain range is covered by two
classes, as it may lead to misclassification.</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>lower</th>
<th>upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_1</annotation></semantics></math></td>
<td>1</td>
<td>30</td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>2</mn></msub><annotation encoding="application/x-tex">k_2</annotation></semantics></math></td>
<td>0.1</td>
<td>1</td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>3</mn></msub><annotation encoding="application/x-tex">k_3</annotation></semantics></math></td>
<td>0</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p>The Zhang &amp; Smith equation describes a theoretical situation,
which may not occur during every experiment. Thus, we prepared different
workflows and modifications (described later on), but the
three-component equation is our desired starting point.</p>
</div>
<div class="section level3">
<h3 id="workflow-selection">Workflow selection<a class="anchor" aria-label="anchor" href="#workflow-selection"></a>
</h3>
<p>We have multiple workflows prepared. We strongly advise using the
first one, but we understand the specificity of each experiment and we
leave the final decision to the user, trusting their motives.</p>
<p>Available workflows:</p>
<ul>
<li>3exp/1exp - we start the fitting process by looking for the best fit
using function <em>x</em> with ranges specified in table <em>x</em>}.
For the peptides with unsatisfactory results, we look for only one
component function (described below). The selection of better results is
made by comparing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
values.</li>
<li>2exp/1exp - the starting point is the two-component function
(described below), and then the one-component function. The decision
process is the same as in the previous point.</li>
<li>3exp/2exp/1exp - all of the variants of the fitting process are
prepared and the best is chosen based on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mi>I</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">BIC</annotation></semantics></math>
value.</li>
</ul>
<div class="section level4">
<h4 id="exp-fit">3exp fit<a class="anchor" aria-label="anchor" href="#exp-fit"></a>
</h4>
<p>The fitting function is described as Zhang &amp; Smith equation
<em>x</em>, with initial values:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>n</mi><mn>2</mn></msub><mo>=</mo><msub><mi>n</mi><mn>3</mn></msub><mo>=</mo><mn>0.33</mn></mrow><annotation encoding="application/x-tex">n_1 = n_2 = n_3 = 0.33</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k_1 = 1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">k_2 = 0.1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>3</mn></msub><mo>=</mo><mn>0.01</mn></mrow><annotation encoding="application/x-tex">k_3 = 0.01</annotation></semantics></math></li>
</ul>
<p>The boundaries for the values are as described in table
<em>x</em>.</p>
<p>The number of unknown parameters is 6.</p>
</div>
<div class="section level4">
<h4 id="exp-fit-1">2exp fit<a class="anchor" aria-label="anchor" href="#exp-fit-1"></a>
</h4>
<p>The two-component fitting function, is described as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><msub><mi>n</mi><mi>a</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>k</mi><mi>a</mi></msub><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>n</mi><mi>b</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><msub><mi>k</mi><mi>b</mi></msub><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
D = n_a \cdot (1 - exp(-k_a \cdot t)) + n_b \cdot (1-exp(-k_b \cdot t)) 
</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
are two of three exchange groups defined for the Zhang &amp; Smith
equation. We perform three fitting processes (for each group
combination) and select the best result comparing the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>R</mi><mn>2</mn></msup><annotation encoding="application/x-tex">R^2</annotation></semantics></math>
value. That means we look for the fit using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_1</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>2</mn></msub><annotation encoding="application/x-tex">k_2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>2</mn></msub><annotation encoding="application/x-tex">k_2</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>3</mn></msub><annotation encoding="application/x-tex">k_3</annotation></semantics></math>,
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_1</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>3</mn></msub><annotation encoding="application/x-tex">k_3</annotation></semantics></math>
and select one as the answer.</p>
<p>The initial value for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>a</mi></msub><annotation encoding="application/x-tex">n_a</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>b</mi></msub><annotation encoding="application/x-tex">n_b</annotation></semantics></math>
is 0.5. The initial values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
are the same with analogical cases from the three-component equation
(see section <em>x</em>).</p>
<p>In this case, we assume that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>a</mi></msub><annotation encoding="application/x-tex">n_a</annotation></semantics></math>
of hydrogen particles are undergoing the exchange with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>a</mi></msub><annotation encoding="application/x-tex">k_a</annotation></semantics></math>
exchange rate, an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>b</mi></msub><annotation encoding="application/x-tex">n_b</annotation></semantics></math>
with exchange rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>b</mi></msub><annotation encoding="application/x-tex">k_b</annotation></semantics></math>.</p>
<p>The number of unknown parameters is 4.</p>
</div>
<div class="section level4">
<h4 id="exp-fit-2">1exp fit<a class="anchor" aria-label="anchor" href="#exp-fit-2"></a>
</h4>
<p>The fitting function is described as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mi>n</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>k</mi><mo>⋅</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
D = n \cdot (1 - exp(-k \cdot t))  
</annotation></semantics></math></p>
<p>In this case, we assume that all of the hydrogen particles in the
peptide are undergoing the exchange in a similar way. Ideally with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>∼</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \sim 1</annotation></semantics></math>.</p>
<p>The initial values for the fit:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n = 1</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k = 1</annotation></semantics></math></li>
<li>upper boundary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= upper boundary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>1</mn></msub><annotation encoding="application/x-tex">k_1</annotation></semantics></math>
</li>
<li>lower boundary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
= lower boundary of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mn>3</mn></msub><annotation encoding="application/x-tex">k_3</annotation></semantics></math>
</li>
</ul>
<p>The number of unknown parameters is 2.</p>
</div>
<div class="section level4">
<h4 id="fitting-parameters">Fitting parameters<a class="anchor" aria-label="anchor" href="#fitting-parameters"></a>
</h4>
<p>To fit the curve we use the nonlinear least square method. For more
information, see the documentation of the used <a href="https://rdocumentation.org/packages/minpack.lm/versions/1.2-3" class="external-link">R
package</a>.</p>
<p>Recommended parameters (possible change):</p>
<ul>
<li>max iteration: 100,</li>
<li>algorithm: Levenberg-Marquardt.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="results-of-the-fitting-process">Results of the fitting process<a class="anchor" aria-label="anchor" href="#results-of-the-fitting-process"></a>
</h3>
<p>TODO: n, k, rgb, interpretation</p>
</div>
<div class="section level3">
<h3 id="calculation-of-estimed-exchange-rate-k">Calculation of estimed exchange rate k<a class="anchor" aria-label="anchor" href="#calculation-of-estimed-exchange-rate-k"></a>
</h3>
<p>As we are working on normalized values and each value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>
is within the limits of (0, 1), whe can treat them somehow as a
probability of getting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>k</mi><mi>i</mi></msub><annotation encoding="application/x-tex">k_i</annotation></semantics></math>.
Then, we can caluclate the estimate k value, aggrgating all of the fit
parameters into one value:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi></mrow></msub><mo>=</mo><mover><mo>∑</mo><mi>i</mi></mover><msub><mi>n</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">
k_{exp} = \sum^i n_i \cdot k_i
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="high-resolution-results">High resolution results<a class="anchor" aria-label="anchor" href="#high-resolution-results"></a>
</h3>
<p>As the classification is performed on uptake curves of each peptide,
there is a need of aggrgation to obtain the high resolution results.
Currently, HRaDeX allows the use of two methods.</p>
<div class="section level4">
<h4 id="selection-of-the-shortest-peptide-">Selection of the shortest peptide.<a class="anchor" aria-label="anchor" href="#selection-of-the-shortest-peptide-"></a>
</h4>
<p>For each residue there is a subset of peptides covering said residue.
From this set, the shortest peptide is chosen as a determinant for the
resiude, as the most represantative.</p>
</div>
<div class="section level4">
<h4 id="aggregation-of-values">Aggregation of values<a class="anchor" aria-label="anchor" href="#aggregation-of-values"></a>
</h4>
<p>Aggregation of values is inspired by the article by Keppler and Weis
(doi: 10.1007/s13361-014-1033-6), with small changes: the ommition of
the first residue is done in different step if demanded by the user. The
aggregation of values is done on a subset of already filtered data.</p>
<p>For each residue there is a subset of peptides covering said residue.
Then, the final
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">n_{i, agg}</annotation></semantics></math>
is calculated from the subset of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>,
with weights inverse proportional to the max uptake of peptide
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">mu_i</annotation></semantics></math>)
- the shortest the peptide the highest the possibility that the uptake
took place in said residue:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mfrac><mfrac><mn>1</mn><mrow><mi>m</mi><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac><mrow><mover><mo>∑</mo><mi>i</mi></mover><mfrac><mn>1</mn><mrow><mi>m</mi><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac></mrow></mfrac></mrow><annotation encoding="application/x-tex">
w_i = \frac{\frac{1}{mu_i}}{\sum^i \frac{1}{mu_i}}
</annotation></semantics></math></p>
<p>Then, the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i%</annotation></semantics></math>
is a weighted average of set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>i</mi></msub><annotation encoding="application/x-tex">n_i</annotation></semantics></math>.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><mo>=</mo><mfrac><mrow><mover><mo>∑</mo><mi>i</mi></mover><msub><mi>w</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>n</mi><mi>i</mi></msub></mrow><mrow><mover><mo>∑</mo><mi>i</mi></mover><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
n_{i, agg} = \frac{\sum^i w_i \cdot n_i}{\sum^i w_i}
</annotation></semantics></math> There is a possibility that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><annotation encoding="application/x-tex">n_{i, agg}</annotation></semantics></math>
obtained that way exceeds the limit of 1. Then, we normalize the values,
to get the sense of proportionality.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi><mi>.</mi><mi>s</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi>e</mi><mi>d</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub><mrow><mover><mo>∑</mo><mi>i</mi></mover><msub><mi>n</mi><mrow><mi>i</mi><mo>,</mo><mi>a</mi><mi>g</mi><mi>g</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">
n_{i, agg.scaled} = \frac{n_{i, agg}}{\sum^i n_{i, agg}}
</annotation></semantics></math></p>
<p>This way, we have the right values to obtain the RGB color value.</p>
<p>The estimated k values are calculated analogically.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="workflow-schema">Workflow schema<a class="anchor" aria-label="anchor" href="#workflow-schema"></a>
</h2>
<p>Figure <em>x</em> presents the diagram for classifying one peptide in
one biological state, based on its uptake curve. This process can be
repeated for each peptide from the data file to access the information
for the set of peptides from a protein.</p>
<div class="float">
<img src="figures/workflow_diagram.png" alt="Workflow schema"><div class="figcaption">Workflow schema</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Weronika Puchala, Michal Burdukiewicz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
